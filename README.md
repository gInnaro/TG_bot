# TG_bot
Так как библиотека Aiogram обновилась до v3, и нужно было обновить функционал бота.
Был переписан код из этого репозитория, https://github.com/gInnaro/bot_sklad, под новые функции и измененные команды.

Идея этого бота была в реализации отправки данных автомобилей, для дальнейшего их заезда на территория организации. 
Сначала мы в ручном режиме редактировали документ формата word, а потом отправляли на почту mail.ru, и это все занимало минут 5, и всегда для этого нужен был компьютер, либо удаленный доступ к нему. И прочитав статью в телеграмм, я узнал что телеграмм боты пишутся на Python, и я начал изучать азы программирования на Python и параллельно писать бота.

Можно посмотреть в репозитории [https://github.com/gInnaro/bot_sklad](https://github.com/gInnaro/bot_sklad/blob/bot-sklad/index.py)https://github.com/gInnaro/bot_sklad/blob/bot-sklad/index.py реализовано обработка команды /pass с дальнейшим отправки данных автомобиля, форме ответа на вопрос, и нажатие на Inline кнопку с выбором на какую организацию должен приехать автомобиль.

И вот пришло обновления пропускной системы для автомобилей, на компьютерное зрение, и данный бот стал не рабочим, так как отказались от почты и отправки документов формата word.
С помощью google chrome, а именно devtools, я просмотрел в какой форме отправляются данные на сервер, для дальнейшего разрешения автомобиля заехать на территорию организации. Так как за время которое работал предыдущая версия бота, я изучал дальше Python и к этому времения я успел изучить библиотеку Request для отправки POST запросы с нужными мне словарём данных. 

Так как мне нужно было последовательное работа всех данных, в нужном порядке, я воспользовался создание класса с подклассом StatesGroup, для обработки команд по нужным мне состояниям.
В основе так же оставил команду /pass для того чтобы начать заполнять данные для оформления пропуск. Так же оставил Inline кнопки для выбора даты, и организации.
Так как ботом могут параллельно несколько пользователей, я добавил DB, и храню последние изменения в файле database.db, где использую как основной столбец для отправки пропуска id пользователя телеграмм. Для удобства чтения и не громождения основного файла, я все команды вынес в отделый файл по названием db.py, где создал класс BotDB, в котором создается новая строка в db, если пользователь не разу не пользовался ботом, и функции по сохранению каждой переданной пользователем данных, и выгрузки данных из db для дальнейшей отправки на сервер.
