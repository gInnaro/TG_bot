# TG_bot
Так как библиотека Aiogram обновилась до v3, нужно было обновить функционал бота. Был переписан код из этого репозитория https://github.com/gInnaro/bot_sklad под новые функции и измененные команды. 
Идея этого бота заключалась в реализации отправки данных автомобилей для дальнейшего заезда на территорию организации. Сначала мы вручную редактировали документ формата Word, а потом отправляли его на почту mail.ru. Этот процесс занимал около 5 минут, и для этого всегда нужен был компьютер или удаленный доступ к нему. Прочитав статью в Telegram, я узнал, что Telegram-боты пишутся на Python, и начал изучать азы программирования на Python, параллельно писал бота. 
Можно посмотреть в репозитории https://github.com/gInnaro/bot_sklad/blob/bot-sklad/index.py. Реализована обработка команды /pass с последующей отправкой данных автомобиля, формой ответа на вопрос и нажатием на Inline-кнопку с выбором организации, на территорию которой должен приехать автомобиль.
И вот пришло обновление пропускной системы для автомобилей, которое перешло на компьютерное зрение, и данный бот перестал работать, так как отказались от почты и отправки документов формата Word. С помощью Google Chrome, а именно DevTools, я просмотрел, в какой форме отправляются данные на сервер для дальнейшего разрешения автомобиля заехать на территорию организации. За время, которое работала предыдущая версия бота, я продолжал изучать Python, и к этому времени мне удалось изучить библиотеку Requests для отправки POST-запросов с нужным мне словарем данных.
Так как мне нужно было последовательно обрабатывать все данные в нужном порядке, я создал класс с подклассом StatesGroup для обработки команд в нужных мне состояниях. Я также оставил команду /pass для начала заполнения данных для оформления пропуска. Я также оставил Inline-кнопки для выбора даты и организации. Так как несколько пользователей могут использовать бота одновременно, я добавил базу данных и храню последние изменения в файле database.db, где использую id пользователя Telegram в качестве основного столбца для отправки пропуска. Для удобства чтения и не нагромождения основного файла, я вынес все команды в отдельный файл с названием db.py, где создал класс BotDB, в котором создается новая строка в базе данных, если пользователь не использовал бота ранее, а также функции для сохранения каждой переданной пользователем данных и выгрузки данных из базы данных для дальнейшей отправки на сервер.
